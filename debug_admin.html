<div class="form-group">
                    <label for="framework">í”„ë ˆì„ì›Œí¬:</label>
                    <select id="framework">
                        <option value="NW">NW ë„¤íŠ¸ì›Œí¬ ê°€ì´ë“œ</option>
                        <option value="KISA">KISA ê°€ì´ë“œ</option>
                        <option value="BOTH">ë‘˜ ë‹¤ ì‹¤í–‰</option>
                    </select>
                </div>                <div class="form-group">
                    <label for="debugLevel">ë””ë²„ê·¸ ë ˆë²¨:</label>
                    <select id="debugLevel">
                        <option value="1">ë ˆë²¨ 1: ê¸°ë³¸ í•¨ìˆ˜ í˜¸ì¶œ</option>
                        <option value="2">ë ˆë²¨ 2: Context ë¶„ì„</option>
                        <option value="3">ë ˆë²¨ 3: ì¸í„°í˜ì´ìŠ¤ ìƒì„¸</option>
                        <option value="4">ë ˆë²¨ 4: ì „ì²´ ë””ë²„ê·¸</option>
                    </select>
                </div><!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NW-23 ë£° ë””ë²„ê¹… ì–´ë“œë¯¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #667eea;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .emoji {
            font-size: 1.2em;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1em;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .config-textarea {
            min-height: 300px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .quick-test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .quick-btn {
            padding: 20px;
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: #333;
            font-weight: 600;
        }
        
        .quick-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        #response {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #28a745;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            border-left-color: #dc3545 !important;
            background: #f8d7da !important;
            color: #721c24;
        }
        
        .success {
            border-left-color: #28a745 !important;
            background: #d4edda !important;
            color: #155724;
        }
        
        .warning {
            border-left-color: #ffc107 !important;
            background: #fff3cd !important;
            color: #856404;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-ok { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-warning { background: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” NW-23 ë£° ë””ë²„ê¹… ì–´ë“œë¯¼</h1>
            <p>ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ë£° í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹… ë„êµ¬</p>
        </div>
        
        <div class="content">
            <!-- API ì„¤ì • ì„¹ì…˜ -->
            <div class="section">
                <h2><span class="emoji">âš™ï¸</span> API ì„œë²„ ì„¤ì •</h2>
                <div class="form-group">
                    <label for="apiUrl">API ì„œë²„ URL:</label>
                    <input type="text" id="apiUrl" placeholder="https://your-api-server.com/api/analyze" value="">
                </div>
                <div class="form-group">
                    <label for="apiKey">API í‚¤ (ì„ íƒì‚¬í•­):</label>
                    <input type="text" id="apiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
            </div>
            
            <!-- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
            <div class="section">
                <h2><span class="emoji">ğŸš€</span> ë¹ ë¥¸ ë””ë²„ê¹… í…ŒìŠ¤íŠ¸</h2>
                <p style="margin-bottom: 20px; color: #666;">ë‹¨ê³„ë³„ ë””ë²„ê¹…ì„ ìœ„í•œ ë¯¸ë¦¬ ì •ì˜ëœ í…ŒìŠ¤íŠ¸ë“¤:</p>
                
                <div class="quick-test-buttons">
                    <div class="quick-btn" onclick="runQuickTest('step1')">
                        <div style="font-size: 1.5em; margin-bottom: 10px;">ğŸ”</div>
                        <div>1ë‹¨ê³„: í•¨ìˆ˜ í˜¸ì¶œ í™•ì¸</div>
                        <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">NW-23 í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸</div>
                    </div>
                    
                    <div class="quick-btn" onclick="runQuickTest('step2')">
                        <div style="font-size: 1.5em; margin-bottom: 10px;">ğŸ“Š</div>
                        <div>2ë‹¨ê³„: Context êµ¬ì¡° ë¶„ì„</div>
                        <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">parsed_interfaces ìƒíƒœ í™•ì¸</div>
                    </div>
                    
                    <div class="quick-btn" onclick="runQuickTest('step3')">
                        <div style="font-size: 1.5em; margin-bottom: 10px;">ğŸ¯</div>
                        <div>3ë‹¨ê³„: íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ ì°¾ê¸°</div>
                        <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">GigabitEthernet0/2 ë¶„ì„</div>
                    </div>
                    
                    <div class="quick-btn" onclick="runQuickTest('step4')">
                        <div style="font-size: 1.5em; margin-bottom: 10px;">ğŸ“</div>
                        <div>4ë‹¨ê³„: ì›ë³¸ ì„¤ì • ë¶„ì„</div>
                        <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">raw config vs parsed ë¹„êµ</div>
                    </div>
                </div>
            </div>
            
            <!-- ìš”ì²­ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° ì„¹ì…˜ -->
            <div class="section">
                <h2><span class="emoji">ğŸ‘€</span> ìš”ì²­ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°</h2>
                <p style="margin-bottom: 15px; color: #666;">APIë¡œ ì „ì†¡ë  ìš”ì²­ ë°ì´í„° í˜•ì‹:</p>
                <div id="requestPreview" style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 12px; border-left: 4px solid #17a2b8;">
                    {
                      "configText": "ì„¤ì • í…ìŠ¤íŠ¸...",
                      "deviceType": "Cisco",
                      "rules": ["NW-23"]
                    }
                </div>
                <button onclick="updateRequestPreview()" style="margin-top: 10px; padding: 8px 16px; font-size: 14px;">ğŸ”„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸</button>
            </div>
            
            <!-- ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
            <div class="section">
                <h2><span class="emoji">ğŸ› ï¸</span> ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸</h2>
                
                <div class="form-group">
                    <label for="testType">í…ŒìŠ¤íŠ¸ ìœ í˜•:</label>
                    <select id="testType" onchange="updateConfigTemplate()">
                        <option value="cisco_basic">Cisco ê¸°ë³¸ ì„¤ì •</option>
                        <option value="cisco_complex">Cisco ë³µì¡í•œ ì„¤ì •</option>
                        <option value="juniper_basic">Juniper ê¸°ë³¸ ì„¤ì •</option>
                        <option value="custom">ì»¤ìŠ¤í…€ ì„¤ì •</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="configText">ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ ì„¤ì •:</label>
                    <textarea id="configText" class="config-textarea" placeholder="ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ ì„¤ì •ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="deviceType">ì¥ë¹„ íƒ€ì…:</label>
                    <select id="deviceType">
                        <option value="Cisco">Cisco</option>
                        <option value="Juniper">Juniper</option>
                        <option value="HP">HP</option>
                        <option value="Alcatel">Alcatel</option>
                        <option value="Radware">Radware</option>
                        <option value="Piolink">Piolink</option>
                        <option value="Extreme">Extreme</option>
                        <option value="Dasan">Dasan</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="testRules">í…ŒìŠ¤íŠ¸í•  ë£° (ì„ íƒì‚¬í•­):</label>
                    <input type="text" id="testRules" placeholder="NW-23 ë˜ëŠ” NW-01,NW-02,NW-23" value="NW-23">
                </div>
                
                <button onclick="runCustomTest()">ğŸ” ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            </div>
            
            <!-- ê²°ê³¼ ì„¹ì…˜ -->
            <div class="section">
                <h2><span class="emoji">ğŸ“‹</span> í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div>API ìš”ì²­ ì²˜ë¦¬ ì¤‘...</div>
                </div>
                
                <div id="response">
                    ì—¬ê¸°ì— API ì‘ë‹µ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                    
                    ìš°ì¸¡ ìƒë‹¨ì˜ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ì„ í´ë¦­í•˜ê±°ë‚˜, 
                    ì»¤ìŠ¤í…€ ì„¤ì •ì„ ì…ë ¥í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”.
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì„¤ì • í…œí”Œë¦¿ë“¤
        const configTemplates = {
            cisco_basic: `Building configuration...
Current configuration : 2000 bytes
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname Test-Router
!
interface GigabitEthernet0/0
 description Link to ISP
 ip address 203.0.113.10 255.255.255.252
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 description Internal Network
 ip address 192.168.1.1 255.255.255.0
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 no ip address
 duplex auto
 speed auto
!
end`,
            
            cisco_complex: `Building configuration...
Current configuration : 5784 bytes
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname Core-Router
!
username netadmin privilege 15 secret 5 $1$fd9K$H7WvLhqKX0Q0NsBnX2iOd1
!
interface GigabitEthernet0/0
 description Link to ISP
 ip address 203.0.113.10 255.255.255.252
 ip nat outside
 ip access-group BLOCK_INBOUND in
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 description Trunk to Core Switch
 no ip address
 duplex auto
 speed auto
!
interface GigabitEthernet0/1.10
 encapsulation dot1Q 10
 description VLAN 10 - Users
 ip address 192.168.10.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/2
 no ip address
 duplex auto
 speed auto
!
end`,
            
            juniper_basic: `version 20.4R3.8;
system {
    host-name test-router;
}
interfaces {
    ge-0/0/0 {
        description "Link to ISP";
        unit 0 {
            family inet {
                address 203.0.113.10/30;
            }
        }
    }
    ge-0/0/1 {
        description "Internal Network";
        unit 0 {
            family inet {
                address 192.168.1.1/24;
            }
        }
    }
    ge-0/0/2 {
        disable;
    }
}`,
            
            custom: ''
        };
        
        // ë””ë²„ê·¸ ë‹¨ê³„ë³„ ìš”ì²­ ë°ì´í„°
        const debugSteps = {
            step1: {
                title: "1ë‹¨ê³„: í•¨ìˆ˜ í˜¸ì¶œ í™•ì¸",
                description: "NW-23 í•¨ìˆ˜ê°€ ì‹¤ì œë¡œ í˜¸ì¶œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.",
                config: configTemplates.cisco_basic,
                debugLevel: 1
            },
            step2: {
                title: "2ë‹¨ê³„: Context êµ¬ì¡° ë¶„ì„", 
                description: "ConfigContextì˜ parsed_interfaces ìƒíƒœë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.",
                config: configTemplates.cisco_complex,
                debugLevel: 2
            },
            step3: {
                title: "3ë‹¨ê³„: íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ ì°¾ê¸°",
                description: "GigabitEthernet0/2ê°€ íŒŒì‹±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.",
                config: configTemplates.cisco_complex,
                debugLevel: 3
            },
            step4: {
                title: "4ë‹¨ê³„: ì›ë³¸ ì„¤ì • ë¶„ì„",
                description: "ì›ë³¸ ì„¤ì •ê³¼ íŒŒì‹± ê²°ê³¼ë¥¼ ë¹„êµ ë¶„ì„í•©ë‹ˆë‹¤.",
                config: configTemplates.cisco_complex,
                debugLevel: 4
            }
        };
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            // ê¸°ë³¸ API URL ì„¤ì • (í•„ìš”ì— ë”°ë¼ ìˆ˜ì •)
            document.getElementById('apiUrl').value = 'http://localhost:8000/api/analyze';
            
            // ê¸°ë³¸ ì„¤ì • í…œí”Œë¦¿ ë¡œë“œ
            updateConfigTemplate();
            
            // ìš”ì²­ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€
            updateRequestPreview();
        };
        
        // ìš”ì²­ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updateRequestPreview() {
            const configText = document.getElementById('configText').value.trim();
            const deviceType = document.getElementById('deviceType').value;
            const testRules = document.getElementById('testRules').value.trim();
            
            let rules = ["NW-23"];
            if (testRules) {
                rules = testRules.split(',').map(r => r.trim()).filter(r => r);
            }
            
            const sampleRequest = {
                configText: configText.substring(0, 100) + "...",
                deviceType: deviceType,
                rules: rules
            };
            
            const previewDiv = document.getElementById('requestPreview');
            if (previewDiv) {
                previewDiv.textContent = JSON.stringify(sampleRequest, null, 2);
            }
        }
        
        // ì„¤ì • í…œí”Œë¦¿ ì—…ë°ì´íŠ¸
        function updateConfigTemplate() {
            const testType = document.getElementById('testType').value;
            const configText = document.getElementById('configText');
            
            if (testType !== 'custom') {
                configText.value = configTemplates[testType];
            }
        }
        
        // ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        function runQuickTest(stepKey) {
            const step = debugSteps[stepKey];
            
            updateResponse(`ğŸš€ ${step.title} ì‹œì‘...\n\n${step.description}\n\ní…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘...`, 'warning');
            
            const requestData = {
                configText: step.config,  // config â†’ configTextë¡œ ë³€ê²½
                deviceType: "Cisco",      // í•„ìˆ˜ í•„ë“œ ì¶”ê°€
                framework: "NW",          // NW í”„ë ˆì„ì›Œí¬ ëª…ì‹œ
                rules: ["NW-23"],         // íŠ¹ì • ë£°ë§Œ ì‹¤í–‰
                debug_level: step.debugLevel,
                target_rule: "NW-23",
                step: stepKey
            };
            
            makeApiRequest(requestData, step.title);
        }
        
        // ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        function runCustomTest() {
            const configText = document.getElementById('configText').value.trim();
            const debugLevel = parseInt(document.getElementById('debugLevel').value);
            const deviceType = document.getElementById('deviceType').value;
            const framework = document.getElementById('framework').value;
            const testRules = document.getElementById('testRules').value.trim();
            
            if (!configText) {
                updateResponse('âŒ ì˜¤ë¥˜: ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            updateResponse(`ğŸ› ï¸ ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ ì‹œì‘ (${framework} í”„ë ˆì„ì›Œí¬)...\n\nì„¤ì • ë¶„ì„ ì¤‘...`, 'warning');
            
            // ë£° ëª©ë¡ ì²˜ë¦¬
            let rules = ["NW-23"];  // ê¸°ë³¸ê°’
            if (testRules) {
                rules = testRules.split(',').map(r => r.trim()).filter(r => r);
            }
            
            const requestData = {
                configText: configText,
                deviceType: deviceType,
                framework: framework,
                rules: rules,
                debug_level: debugLevel,
                target_rule: "NW-23",
                step: "custom"
            };
            
            makeApiRequest(requestData, `ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ (${framework})`);
        }
        
        // API ìš”ì²­ ì‹¤í–‰
        async function makeApiRequest(requestData, testTitle) {
            const apiUrl = document.getElementById('apiUrl').value.trim();
            const apiKey = document.getElementById('apiKey').value.trim();
            
            if (!apiUrl) {
                updateResponse('âŒ ì˜¤ë¥˜: API URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            document.getElementById('loading').style.display = 'block';
            
            try {
                const headers = {
                    'Content-Type': 'application/json',
                };
                
                if (apiKey) {
                    headers['Authorization'] = `Bearer ${apiKey}`;
                    // ë˜ëŠ” headers['X-API-Key'] = apiKey;
                }
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(requestData)
                });
                
                const responseText = await response.text();
                let responseData;
                
                try {
                    responseData = JSON.parse(responseText);
                } catch (e) {
                    responseData = responseText;
                }
                
                // ë¡œë”© ìˆ¨ê¹€
                document.getElementById('loading').style.display = 'none';
                
                if (response.ok) {
                    displayApiResponse(responseData, testTitle, 'success');
                } else {
                    displayApiResponse(responseData, testTitle, 'error');
                }
                
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                updateResponse(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}\n\nAPI URLì„ í™•ì¸í•´ì£¼ì„¸ìš”: ${apiUrl}`, 'error');
            }
        }
        
        // API ì‘ë‹µ í‘œì‹œ
        function displayApiResponse(data, testTitle, status) {
            let output = `ğŸ“Š ${testTitle} ì™„ë£Œ (${new Date().toLocaleTimeString()})\n`;
            output += `${'='.repeat(60)}\n\n`;
            
            if (typeof data === 'string') {
                output += data;
            } else {
                // JSON ë°ì´í„°ë¥¼ ë³´ê¸° ì¢‹ê²Œ í¬ë§·
                if (data.vulnerabilities && Array.isArray(data.vulnerabilities)) {
                    output += `ğŸ” ë°œê²¬ëœ ì·¨ì•½ì : ${data.vulnerabilities.length}ê°œ\n\n`;
                    
                    data.vulnerabilities.forEach((vuln, index) => {
                        output += `${index + 1}. ${vuln.rule || 'Unknown'}: ${vuln.matched_text || vuln.interface_name || 'N/A'}\n`;
                        output += `   ğŸ“ ìœ„ì¹˜: ë¼ì¸ ${vuln.line || 'N/A'}\n`;
                        output += `   ğŸ“ ìƒì„¸: ${vuln.details?.reason || vuln.reason || 'N/A'}\n`;
                        
                        if (vuln.details?.debug_info) {
                            output += `   ğŸ› ë””ë²„ê·¸ ì •ë³´:\n`;
                            Object.entries(vuln.details.debug_info).forEach(([key, value]) => {
                                output += `      - ${key}: ${JSON.stringify(value)}\n`;
                            });
                        }
                        
                        if (vuln.details?.analysis_details) {
                            output += `   ğŸ“Š ë¶„ì„ ê²°ê³¼:\n`;
                            Object.entries(vuln.details.analysis_details).forEach(([key, value]) => {
                                output += `      - ${key}: ${JSON.stringify(value)}\n`;
                            });
                        }
                        
                        output += `\n`;
                    });
                } else {
                    // ì „ì²´ JSON ì¶œë ¥
                    output += JSON.stringify(data, null, 2);
                }
            }
            
            updateResponse(output, status);
        }
        
        // ì‘ë‹µ ì˜ì—­ ì—…ë°ì´íŠ¸
        function updateResponse(content, type = 'success') {
            const responseDiv = document.getElementById('response');
            responseDiv.textContent = content;
            responseDiv.className = type;
            
            // ìë™ ìŠ¤í¬ë¡¤
            responseDiv.scrollTop = responseDiv.scrollHeight;
        }
        
        // Enter í‚¤ë¡œ API URL í…ŒìŠ¤íŠ¸
        document.getElementById('apiUrl').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                runQuickTest('step1');
            }
        });
    </script>
</body>
</html>